"use strict";(()=>{var e={};e.id=6271,e.ids=[6271],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},629:e=>{e.exports=require("fs/promises")},5315:e=>{e.exports=require("path")},2455:(e,t,i)=>{i.r(t),i.d(t,{originalPathname:()=>m,patchFetch:()=>p,requestAsyncStorage:()=>c,routeModule:()=>u,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var r={};i.r(r),i.d(r,{GET:()=>l});var s=i(9303),o=i(8716),a=i(670);i(7702),i(629),i(5315),i(7536);let n=[{source:"ReactGenerator",message:"Am\xe9lioration du prompt de g\xe9n\xe9ration : ajout des hooks auto.",date:"2025-09-04T13:00:00Z"},{source:"MemorySystem",message:"Suppression des duplications de composants similaires.",date:"2025-09-03T15:22:00Z"},{source:"BrainSystem",message:"Optimisation de la strat\xe9gie de g\xe9n\xe9ration pour les composants TypeScript.",date:"2025-09-03T10:15:00Z"},{source:"CodeValidator",message:"Apprentissage de nouveaux patterns d'erreurs React.",date:"2025-09-02T16:45:00Z"},{source:"LearningSystem",message:"D\xe9couverte d'un pattern r\xe9current : composants avec hooks personnalis\xe9s.",date:"2025-09-02T09:30:00Z"}];async function l(){try{let e=await n;return Response.json(e)}catch(e){return new Response(JSON.stringify({error:"Erreur apprentissage"}),{status:500})}}let u=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/learning/route",pathname:"/api/learning",filename:"route",bundlePath:"app/api/learning/route"},resolvedPagePath:"C:\\Users\\guima\\Desktop\\Dashboard IA Project\\jarvis-workstation\\app\\api\\learning\\route.js",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:h,serverHooks:g}=u,m="/api/learning/route";function p(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},9303:(e,t,i)=>{e.exports=i(517)},7536:(e,t,i)=>{i.d(t,{Z:()=>n});var r=i(629),s=i(5315),o=i(2048),a=i(7702);class n extends a.EventEmitter{constructor(e="Jarvis",t={}){super(),this.context=e,this.config={level:process.env.LOG_LEVEL||"info",format:"json",output:["console","file"],logDir:"./logs",maxFileSize:10485760,maxFiles:5,enableColors:!0,enableTimestamp:!0,enableContext:!0,enableMetadata:!0,remoteEndpoint:null,...t},this.levels={error:{priority:0,color:"\x1b[31m",emoji:"❌"},warn:{priority:1,color:"\x1b[33m",emoji:"⚠️"},info:{priority:2,color:"\x1b[36m",emoji:"ℹ️"},debug:{priority:3,color:"\x1b[35m",emoji:"\uD83D\uDD0D"},trace:{priority:4,color:"\x1b[37m",emoji:"\uD83D\uDD2C"}},this.state={isInitialized:!1,fileStream:null,buffer:[],stats:{totalLogs:0,errorCount:0,warnCount:0,lastError:null,startTime:Date.now()}},this.initialize()}async initialize(){try{await this.ensureLogDirectory(),this.config.output.includes("file")&&await this.setupFileLogging(),this.config.remoteEndpoint&&await this.setupRemoteLogging(),this.state.isInitialized=!0,this.info("Logger initialis\xe9",{context:this.context,config:this.config})}catch(e){console.error("❌ Erreur initialisation logger:",e)}}error(e,t={},i=null){this.log("error",e,{...t,error:i?.stack||i}),this.state.stats.errorCount++,this.state.stats.lastError={message:e,timestamp:Date.now(),error:i}}warn(e,t={}){this.log("warn",e,t),this.state.stats.warnCount++}info(e,t={}){this.log("info",e,t)}debug(e,t={}){this.log("debug",e,t)}trace(e,t={}){this.log("trace",e,t)}log(e,t,i={}){if(!this.shouldLog(e))return;let r=this.createLogEntry(e,t,i);this.state.stats.totalLogs++,this.config.output.includes("console")&&this.logToConsole(r),this.config.output.includes("file")&&this.state.fileStream&&this.logToFile(r),this.config.remoteEndpoint&&this.logToRemote(r),this.emit("log",r),this.emit(e,r)}shouldLog(e){let t=this.levels[this.config.level]?.priority??2;return(this.levels[e]?.priority??2)<=t}createLogEntry(e,t,i={}){let r=new Date().toISOString();this.levels[e]||this.levels.info;let s={timestamp:r,level:e.toUpperCase(),context:this.context,message:t,pid:process.pid,hostname:process.env.HOSTNAME||"localhost"};return this.config.enableMetadata&&Object.keys(i).length>0&&(s.metadata=i),("error"===e||"warn"===e)&&(s.system={memory:process.memoryUsage(),uptime:process.uptime(),version:process.version}),s}logToConsole(e){let t=this.levels[e.level.toLowerCase()],i=this.config.enableColors?t.color:"",r=this.config.enableColors?"\x1b[0m":"",s=t.emoji,o="";"json"===this.config.format?o=JSON.stringify(e):"structured"===this.config.format?o=this.formatStructured(e):(o=`${s} [${e.timestamp}] ${e.level} [${e.context}]: ${e.message}`,e.metadata&&Object.keys(e.metadata).length>0&&(o+=` ${JSON.stringify(e.metadata)}`)),console.log(`${i}${o}${r}`)}logToFile(e){if(!this.state.fileStream)return;let t=JSON.stringify(e)+"\n";this.state.fileStream.write(t),this.checkFileRotation()}async logToRemote(e){try{this.state.buffer.push(e),this.state.buffer.length>=10&&await this.flushRemoteBuffer()}catch(e){console.error("Erreur logging distant:",e.message)}}formatStructured(e){let t=[`[${e.timestamp}]`,`${e.level.padEnd(5)}`,`[${e.context}]`,e.message].join(" ");if(e.metadata){let i=Object.entries(e.metadata).map(([e,t])=>`${e}=${JSON.stringify(t)}`).join(" ");i&&(t+=` | ${i}`)}return t}async setupFileLogging(){let e=s.join(this.config.logDir,`${this.context.toLowerCase()}.log`);this.state.fileStream=(0,o.createWriteStream)(e,{flags:"a"}),this.state.fileStream.on("error",e=>{console.error("❌ Erreur stream de log:",e)})}async checkFileRotation(){try{let e=s.join(this.config.logDir,`${this.context.toLowerCase()}.log`);(await r.stat(e)).size>this.config.maxFileSize&&await this.rotateLogFile()}catch(e){}}async rotateLogFile(){try{let e=s.join(this.config.logDir,`${this.context.toLowerCase()}.log`);this.state.fileStream&&this.state.fileStream.end();for(let t=this.config.maxFiles-1;t>0;t--){let i=`${e}.${t}`,s=`${e}.${t+1}`;try{await r.rename(i,s)}catch(e){}}await r.rename(e,`${e}.1`),await this.setupFileLogging(),this.info("Rotation des logs effectu\xe9e",{maxSize:this.config.maxFileSize,maxFiles:this.config.maxFiles})}catch(e){console.error("❌ Erreur rotation logs:",e)}}async setupRemoteLogging(){setInterval(()=>{this.state.buffer.length>0&&this.flushRemoteBuffer()},3e4)}async flushRemoteBuffer(){if(0===this.state.buffer.length)return;let e=[...this.state.buffer];this.state.buffer=[];try{let t=await fetch(this.config.remoteEndpoint,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${process.env.LOG_TOKEN||""}`},body:JSON.stringify({logs:e})});if(!t.ok)throw Error(`HTTP ${t.status}: ${t.statusText}`)}catch(t){this.state.buffer.unshift(...e),console.error("❌ Erreur envoi logs distants:",t.message)}}async ensureLogDirectory(){try{await r.mkdir(this.config.logDir,{recursive:!0})}catch(e){console.error("❌ Erreur cr\xe9ation r\xe9pertoire logs:",e)}}setLevel(e){this.levels[e]?(this.config.level=e,this.info(`Niveau de log chang\xe9: ${e}`)):this.warn(`Niveau de log invalide: ${e}`)}addOutput(e){this.config.output.includes(e)||(this.config.output.push(e),this.info(`Output ajout\xe9: ${e}`))}removeOutput(e){let t=this.config.output.indexOf(e);t>-1&&(this.config.output.splice(t,1),this.info(`Output supprim\xe9: ${e}`))}getStats(){return{...this.state.stats,uptime:Date.now()-this.state.stats.startTime,level:this.config.level,outputs:this.config.output,bufferSize:this.state.buffer.length}}async cleanup(e=6048e5){try{let t=await r.readdir(this.config.logDir),i=Date.now();for(let o of t){let t=s.join(this.config.logDir,o),a=await r.stat(t);i-a.mtime.getTime()>e&&(await r.unlink(t),this.info(`Fichier de log supprim\xe9: ${o}`,{age:i-a.mtime.getTime()}))}}catch(e){this.error("Erreur nettoyage logs",{},e)}}async search(e,t={}){let{level:i=null,startDate:o=null,endDate:a=null,limit:n=100}=t;try{let t=s.join(this.config.logDir,`${this.context.toLowerCase()}.log`),l=(await r.readFile(t,"utf8")).split("\n").filter(e=>e.trim()),u=[];for(let t of l)try{let r=JSON.parse(t);if(i&&r.level.toLowerCase()!==i.toLowerCase())continue;let s=new Date(r.timestamp);if(o&&s<o||a&&s>a)continue;if(JSON.stringify(r).toLowerCase().includes(e.toLowerCase())&&u.push(r),u.length>=n)break}catch(e){}return u}catch(e){return this.error("Erreur recherche logs",{},e),[]}}async export(e="json",t={}){let{startDate:i=null,endDate:r=null,level:s=null}=t;try{let t=await this.search("",{startDate:i,endDate:r,level:s,limit:1e4});switch(e){case"json":return JSON.stringify(t,null,2);case"csv":return this.exportToCSV(t);case"txt":return t.map(e=>`[${e.timestamp}] ${e.level} [${e.context}]: ${e.message}`).join("\n");default:throw Error(`Format d'export non support\xe9: ${e}`)}}catch(e){throw this.error("Erreur export logs",{},e),e}}exportToCSV(e){let t=["timestamp,level,context,message,metadata"];for(let i of e){let e=[i.timestamp,i.level,i.context,`"${i.message.replace(/"/g,'""')}"`,`"${JSON.stringify(i.metadata||{}).replace(/"/g,'""')}"`];t.push(e.join(","))}return t.join("\n")}async close(){try{this.state.buffer.length>0&&await this.flushRemoteBuffer(),this.state.fileStream&&this.state.fileStream.end(),this.info("Logger ferm\xe9 proprement")}catch(e){console.error("❌ Erreur fermeture logger:",e)}}}}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[8948],()=>i(2455));module.exports=r})();