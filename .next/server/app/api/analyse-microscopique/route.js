"use strict";(()=>{var e={};e.id=3289,e.ids=[3289],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1282:e=>{e.exports=require("child_process")},5315:e=>{e.exports=require("path")},1764:e=>{e.exports=require("util")},6151:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>q,patchFetch:()=>g,requestAsyncStorage:()=>x,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{POST:()=>m});var o=t(9303),a=t(8716),i=t(670),n=t(7070),c=t(1282),u=t(1764),l=t(5315),p=t.n(l);let d=(0,u.promisify)(c.exec);async function m(e){try{let{dossierCible:r,action:t}=await e.json(),s=p().join(process.cwd(),"scripts","analyse-microscopique-2025.cjs"),o="";switch(t){case"analyser":o=`node "${s}" --dossier="${r}"`;break;case"analyser-tout":o=`node "${s}" --tout`;break;default:return n.NextResponse.json({error:"Action non reconnue"},{status:400})}console.log(`Ex\xe9cution de la commande: ${o}`);let{stdout:a,stderr:i}=await d(o,{cwd:process.cwd(),timeout:3e5});i&&console.error("Erreur stderr:",i);let c=function(e){let r=e.split("\n"),t=0,s=0,o=0,a="termine";for(let e of r){if(e.includes("Total fichiers analys\xe9s")){let r=e.match(/(\d+)/);r&&(t=parseInt(r[1]))}if(e.includes("Corrections d\xe9tect\xe9es")){let r=e.match(/(\d+)/);r&&(s=parseInt(r[1]))}if(e.includes("Score utilit\xe9")){let r=e.match(/(\d+\.?\d*)/);r&&(o=parseFloat(r[1]))}(e.includes("ERREUR")||e.includes("\xc9CHEC"))&&(a="erreur")}return{fichiers_analyses:t,corrections_detectees:s,score_utilite:o,statut:a,timestamp:new Date().toISOString()}}(a);return n.NextResponse.json({success:!0,resultats:c,logs:a,erreurs:i})}catch(e){return console.error("Erreur lors de l'analyse:",e),n.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Erreur inconnue"},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/analyse-microscopique/route",pathname:"/api/analyse-microscopique",filename:"route",bundlePath:"app/api/analyse-microscopique/route"},resolvedPagePath:"C:\\Users\\guima\\Desktop\\Dashboard IA Project\\jarvis-workstation\\app\\api\\analyse-microscopique\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:x,staticGenerationAsyncStorage:f,serverHooks:y}=h,q="/api/analyse-microscopique/route";function g(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:f})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,5972],()=>t(6151));module.exports=s})();