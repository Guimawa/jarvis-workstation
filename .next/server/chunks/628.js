"use strict";exports.id=628,exports.ids=[628],exports.modules={628:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var i=s(8631),r=s(629);s(5315);class l{constructor(){this.rules={complexity:{maxCyclomatic:10,maxLines:100,maxDepth:4},security:{disallowedPatterns:[/eval\(/,/Function\(/,/\.innerHTML\s*=/,/\.outerHTML\s*=/,/document\.write/,/setTimeout\(.*\)/,/setInterval\(.*\)/]},quality:{requireComments:!0,minCommentRatio:.1,disallowedPatterns:[/console\.log/,/debugger/,/alert\(/]}}}validateSyntax(e,t="unknown.js"){try{let t=(0,i.Qc)(e,{sourceType:"module",plugins:["typescript","jsx","decorators","classProperties"],allowAwaitOutsideFunction:!0,allowReturnOutsideFunction:!0});return{valid:!0,ast:t,errors:[]}}catch(e){return{valid:!1,errors:[{line:e.loc?.line,column:e.loc?.column,message:e.message,severity:"error"}]}}}analyzeComplexity(e){let t=e.split("\n"),s=[],i=this.calculateCyclomaticComplexity(e);i>this.rules.complexity.maxCyclomatic&&s.push({type:"complexity",message:`Complexit\xe9 cyclomatique \xe9lev\xe9e: ${i} (max: ${this.rules.complexity.maxCyclomatic})`,severity:"warning"}),t.length>this.rules.complexity.maxLines&&s.push({type:"size",message:`Fichier trop long: ${t.length} lignes (max: ${this.rules.complexity.maxLines})`,severity:"warning"});let r=this.calculateNestedDepth(e);return r>this.rules.complexity.maxDepth&&s.push({type:"nesting",message:`Nesting trop profond: ${r} niveaux (max: ${this.rules.complexity.maxDepth})`,severity:"warning"}),{score:Math.max(0,100-(2*i+5*r)),issues:s,metrics:{lines:t.length,cyclomaticComplexity:i,nestedDepth:r}}}calculateCyclomaticComplexity(e){let t=1;return[/if\s*\(/g,/else\s*if\s*\(/g,/for\s*\(/g,/while\s*\(/g,/case\s*:/g,/catch\s*\(/g,/\?\s*.*\s*:/g,/&&/g,/\|\|/g].forEach(s=>{let i=e.match(s);i&&(t+=i.length)}),t}calculateNestedDepth(e){let t=0,s=0,i=[];for(let r of e.split(/([{}()\[\]])/))["{","(","["].includes(r)?(i.push(r),t=Math.max(t,++s)):["}",")","]"].includes(r)&&i.length>0&&(i.pop(),s--);return t}checkSecurity(e){let t=[];return this.rules.security.disallowedPatterns.forEach((s,i)=>{e.match(s)&&t.push({type:"security",message:`Pattern de s\xe9curit\xe9 d\xe9tect\xe9: ${s.toString()}`,severity:"high",pattern:s.toString()})}),t}checkQuality(e){let t=[],s=e.split("\n"),i=s.filter(e=>e.trim().startsWith("//")||e.trim().startsWith("/*")||e.trim().includes("/**")).length,r=i/s.length;return r<this.rules.quality.minCommentRatio&&t.push({type:"documentation",message:`Ratio de commentaires faible: ${(100*r).toFixed(1)}% (min: ${100*this.rules.quality.minCommentRatio}%)`,severity:"info"}),this.rules.quality.disallowedPatterns.forEach(s=>{e.match(s)&&t.push({type:"quality",message:`Pattern de d\xe9veloppement d\xe9tect\xe9: ${s.toString()}`,severity:"low",pattern:s.toString()})}),{issues:t,metrics:{totalLines:s.length,commentLines:i,commentRatio:r}}}async validateCode(e,t={}){let s=this.validateSyntax(e);if(!s.valid)return{valid:!1,severity:"error",issues:s.errors,metrics:null};let i=this.analyzeComplexity(e),r=this.checkSecurity(e),l=this.checkQuality(e),a=[...i.issues,...r,...l.issues],n=a.some(e=>"error"===e.severity),o=a.some(e=>"warning"===e.severity);return{valid:!n,severity:n?"error":o?"warning":"info",issues:a,metrics:{...i.metrics,...l.metrics,complexityScore:i.score},suggestions:this.generateSuggestions(a)}}generateSuggestions(e){return e.map(e=>{switch(e.type){case"complexity":return"Consid\xe9rez de diviser cette fonction en plusieurs fonctions plus petites";case"security":return"\xc9vitez les patterns potentiellement dangereux pour la s\xe9curit\xe9";case"documentation":return"Ajoutez plus de commentaires pour am\xe9liorer la maintenabilit\xe9";default:return"Revoyez cette partie du code pour l'am\xe9liorer"}})}async validateFile(e){try{let t=await (0,r.readFile)(e,"utf8");return await this.validateCode(t,{filepath:e})}catch(e){return{valid:!1,severity:"error",issues:[{message:`Impossible de lire le fichier: ${e.message}`,severity:"error"}],metrics:null}}}}let a=l}};